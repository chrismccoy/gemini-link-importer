jQuery(document).ready(function(l){var e=l("#gemini-link-importer-form"),m=l("#gemini-link-importer-textarea"),i=l("#gemini-link-importer-submit"),n=l("#gemini-link-importer-admin-notices");function a(e,i){console.log('Gemini Link Importer: Displaying admin notice of type "'+e+'".'),n.html('<div class="gemini-link-importer-notice notice-'+e+' is-dismissible">'+i+'<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button></div>'),l(".gemini-link-importer-notice .notice-dismiss").on("click",function(){console.log("Gemini Link Importer: Admin notice dismissed."),l(this).closest(".gemini-link-importer-notice").remove()})}console.log("Gemini Link Importer: Admin script initialized."),e.on("submit",function(e){e.preventDefault(),console.log("Gemini Link Importer: Form submission initiated."),console.log("Gemini Link Importer: Clearing previous admin notices."),n.empty();var e=m.val().trim();console.log("Gemini Link Importer: Textarea content (trimmed):",e),e?(console.log("Gemini Link Importer: Disabling submit button and showing spinner."),i.prop("disabled",!0).addClass("is-loading").text(geminiLinkImporterAjax.strings.importing_links),e={action:"gemini_import_links",nonce:geminiLinkImporterAjax.nonce,links:e},console.log("Gemini Link Importer: AJAX request data:",e),l.ajax({url:geminiLinkImporterAjax.ajaxurl,type:"POST",data:e,dataType:"json",success:function(e){var i,n,o,r,s,t;console.log("Gemini Link Importer: AJAX success callback received.",e),m.val(""),console.log("Gemini Link Importer: Textarea cleared."),e.success?(n=(i=e.data).imported.length,o=i.failed.length,r=i.new_categories.length,console.log("Gemini Link Importer: Import Results ->"),console.log("  Imported:",n,"links",i.imported),console.log("  Failed:",o,"links",i.failed),console.log("  New Categories:",r,"categories",i.new_categories),console.log("  Total Processed Lines:",i.total_processed),s="",t="info",0<n&&0===o?(console.log("Gemini Link Importer: All valid links imported successfully."),s+="<p><strong>"+geminiLinkImporterAjax.strings.overall_success.replace("%d",n)+"</strong></p>",t="success"):0<n&&0<o?(console.log("Gemini Link Importer: Mixed results - some imported, some failed."),s+="<p><strong>"+geminiLinkImporterAjax.strings.partial_success.replace("%d",n).replace("%d",o).replace("%d",r)+"</strong></p>",t="warning"):0===n&&0<o&&0<i.total_processed?(console.log("Gemini Link Importer: All submitted links failed."),s+="<p><strong>"+geminiLinkImporterAjax.strings.overall_failure.replace("%d",o)+"</strong></p>",t="error"):0===i.total_processed&&(console.log("Gemini Link Importer: No valid lines found to process from input."),s+="<p><strong>"+geminiLinkImporterAjax.strings.no_valid_links+"</strong></p>",t="info"),0<n&&(console.log("Gemini Link Importer: Appending successfully imported list."),s=s+("<h3>"+geminiLinkImporterAjax.strings.successfully_added.replace("%d",n))+"</h3><ul>",l.each(i.imported,function(e,i){s+="<li>"+i+"</li>"}),s+="</ul>"),0<o&&(console.log("Gemini Link Importer: Appending failed links list."),s=s+("<h3>"+geminiLinkImporterAjax.strings.failed_to_add.replace("%d",o))+"</h3><ul>",l.each(i.failed,function(e,i){s+="<li>"+i.url+" - "+i.reason+"</li>"}),s+="</ul>"),0<r&&(console.log("Gemini Link Importer: Appending new categories list."),s=s+("<h3>"+geminiLinkImporterAjax.strings.new_categories.replace("%d",r))+"</h3><ul>",l.each(i.new_categories,function(e,i){s+="<li>"+i+"</li>"}),s+="</ul>"),a(t,s)):(console.error("Gemini Link Importer: AJAX response indicates failure.",e),a("error","<p><strong>"+(geminiLinkImporterAjax.strings.message||"An unknown error occurred on the server.")+"</strong></p>"))},error:function(e,i,n){console.error("Gemini Link Importer: AJAX Error ->",i,n,e),a("error","<p><strong>"+geminiLinkImporterAjax.strings.overall_failure.replace("%d",0)+"</strong></p><p>An unexpected error occurred during the request. Please try again or check the browser console for details.</p>")},complete:function(){console.log("Gemini Link Importer: AJAX request completed. Re-enabling submit button."),i.prop("disabled",!1).removeClass("is-loading").text(geminiLinkImporterAjax.strings.import_links)}})):(console.log("Gemini Link Importer: Textarea is empty. Preventing AJAX submission."),a("info","<p>"+geminiLinkImporterAjax.strings.empty_textarea+"</p>"))})});